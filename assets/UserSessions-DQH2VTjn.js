import{_ as g,r as o,k as D,o as T,c as m,a as e,l as k,v as C,n as c,F as $,d as x,t as n,g as M,j as S,D as w}from"./index-Lnb-9Fda.js";const b={class:"user-sessions"},U={class:"filter-bar"},Y={class:"filter-tags"},j={class:"session-list"},B=["onClick"],L={class:"duration-progress"},z=["title"],F={__name:"UserSessions",setup(H){const f=S(),_=(s,t="YYYY-MM-DD HH:mm:ss")=>w(s).format(t),i=o("all"),u=o(""),d=s=>{i.value=s},v=o([{id:1,userId:"user_001",startTime:"2024-01-20T10:00:00",endTime:"2024-01-20T10:00:05",duration:5,userType:"loyal"},{id:2,userId:"user_002",startTime:"2024-01-20T11:15:00",endTime:"2024-01-20T11:15:12",duration:12},{id:3,userId:"user_003",startTime:"2024-01-20T09:30:00",endTime:"2024-01-20T09:30:08",duration:8},{id:4,userId:"user_004",startTime:"2024-01-20T13:00:00",endTime:"2024-01-20T13:15:00",duration:900},{id:5,userId:"user_005",startTime:"2024-01-20T14:20:00",endTime:"2024-01-20T14:20:06",duration:6},{id:6,userId:"user_006",startTime:"2024-01-20T08:00:00",endTime:"2024-01-20T08:00:15",duration:15},{id:7,userId:"user_007",startTime:"2024-01-20T16:00:00",endTime:"2024-01-20T16:20:00",duration:1200},{id:8,userId:"user_008",startTime:"2024-01-20T12:30:00",endTime:"2024-01-20T12:30:04",duration:4},{id:9,userId:"user_009",startTime:"2024-01-20T15:00:00",endTime:"2024-01-20T15:00:25",duration:25},{id:10,userId:"user_010",startTime:"2024-01-20T10:30:00",endTime:"2024-01-20T10:30:07",duration:7},{id:11,userId:"user_011",startTime:"2024-01-20T13:45:00",endTime:"2024-01-20T14:00:00",duration:900},{id:12,userId:"user_012",startTime:"2024-01-20T09:15:00",endTime:"2024-01-20T09:15:03",duration:3},{id:13,userId:"user_013",startTime:"2024-01-20T11:30:00",endTime:"2024-01-20T11:30:18",duration:18},{id:14,userId:"user_014",startTime:"2024-01-20T14:00:00",endTime:"2024-01-20T14:00:09",duration:9},{id:15,userId:"user_015",startTime:"2024-01-20T15:30:00",endTime:"2024-01-20T16:00:00",duration:1800},{id:16,userId:"user_016",startTime:"2024-01-20T08:30:00",endTime:"2024-01-20T08:30:05",duration:5},{id:17,userId:"user_017",startTime:"2024-01-20T12:00:00",endTime:"2024-01-20T12:00:11",duration:11},{id:18,userId:"user_018",startTime:"2024-01-20T16:30:00",endTime:"2024-01-20T16:30:06",duration:6},{id:19,userId:"user_019",startTime:"2024-01-20T10:15:00",endTime:"2024-01-20T10:15:08",duration:8},{id:20,userId:"user_020",startTime:"2024-01-20T13:15:00",endTime:"2024-01-20T13:15:14",duration:14}]),p=s=>{const t=Math.floor(s/3600),r=Math.floor(s%3600/60),l=s%60,a=[];return t>0&&a.push(`${t}小时`),r>0&&a.push(`${r}分钟`),l>0&&a.push(`${l}秒`),a.join(" ")},I=s=>{const t=Math.max(...v.value.map(r=>r.duration));return s/t*100},h=D(()=>{let s=v.value;if(i.value!=="all"&&(s=s.filter(t=>i.value==="loyal"?t.duration>=600:i.value==="churn"?t.duration<10:!0)),u.value){const t=u.value.toLowerCase();s=s.filter(r=>r.userId.toLowerCase().includes(t))}return s}),y=s=>{f.push(`/user/timeline/${s}`)};return(s,t)=>(T(),m("div",b,[t[5]||(t[5]=e("div",{class:"page-header"},[e("h2",null,"用户会话分析")],-1)),e("div",U,[k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>u.value=r),placeholder:"搜索会话",class:"search-input"},null,512),[[C,u.value]]),e("div",Y,[e("span",{class:c(["filter-tag",{active:i.value==="loyal"}]),onClick:t[1]||(t[1]=r=>d("loyal"))}," 铁粉 ",2),e("span",{class:c(["filter-tag",{active:i.value==="churn"}]),onClick:t[2]||(t[2]=r=>d("churn"))}," 迅速流失用户 ",2),e("span",{class:c(["filter-tag",{active:i.value==="all"}]),onClick:t[3]||(t[3]=r=>d("all"))}," 全部用户 ",2)])]),e("div",j,[e("table",null,[t[4]||(t[4]=e("thead",null,[e("tr",null,[e("th",null,"用户ID"),e("th",null,"开始时间"),e("th",null,"结束时间"),e("th",null,"会话时长"),e("th",null,"时长进度")])],-1)),e("tbody",null,[(T(!0),m($,null,x(h.value,r=>(T(),m("tr",{key:r.id,onClick:l=>y(r.userId),class:"session-row"},[e("td",null,n(r.userId),1),e("td",null,n(_(r.startTime)),1),e("td",null,n(_(r.endTime)),1),e("td",null,n(p(r.duration)),1),e("td",null,[e("div",L,[e("div",{class:"progress-bar",style:M({width:I(r.duration)+"%"}),title:p(r.duration)},null,12,z)])])],8,B))),128))])])])]))}},q=g(F,[["__scopeId","data-v-89c4dce9"]]);export{q as default};
