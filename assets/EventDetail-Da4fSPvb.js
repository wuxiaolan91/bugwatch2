import{_ as Y,r as c,q,s as C,c as a,a as t,t as n,u as y,F as m,d as _,x as I,y as r,o as d,n as R,B as z,j as L}from"./index-CRI02doo.js";const P={class:"event-detail"},S={class:"page-header"},A={class:"header-left"},B={class:"event-name"},N={class:"detail-section"},j={class:"info-grid"},F={class:"info-item"},H={class:"info-item"},O={class:"info-item"},$={class:"info-item"},J={class:"detail-section"},U={class:"property-table"},V={class:"detail-section"},G={class:"section-header"},K={class:"period-selector"},Q=["onClick"],W={class:"detail-section"},X={class:"trigger-table"},Z={class:"property-json"},tt={__name:"EventDetail",setup(et){z();const h=L(),p=c(null);let o=null;const k=[{days:7,label:"近7天"},{days:14,label:"近14天"},{days:30,label:"近30天"}],f=c(7),l=c({id:1,name:"view_product",description:"用户查看商品详情",type:"pv",createdAt:"2024-01-10T08:30:00",lastTriggered:"2024-01-20T15:45:30",properties:[{key:"product_id",type:"string",description:"商品ID",required:!0},{key:"category",type:"string",description:"商品分类",required:!0},{key:"price",type:"number",description:"商品价格",required:!0},{key:"source",type:"string",description:"商品来源",required:!1}],trend:[{date:"2024-01-14",count:1234},{date:"2024-01-15",count:1567},{date:"2024-01-16",count:1432},{date:"2024-01-17",count:1789},{date:"2024-01-18",count:1654},{date:"2024-01-19",count:1876},{date:"2024-01-20",count:1543}]}),D=c([{id:1,timestamp:"2024-01-20T15:45:30",userId:"user_123456",deviceType:"iPhone 14",properties:{product_id:"P001",category:"手机",price:6999,source:"首页推荐"}},{id:2,timestamp:"2024-01-20T15:43:22",userId:"user_123457",deviceType:"Chrome",properties:{product_id:"P002",category:"电脑",price:8999,source:"搜索结果"}}]),T=i=>({pv:"页面浏览",click:"点击事件",custom:"自定义事件"})[i]||i,g=()=>{if(!p.value)return;o=I(p.value);const i={tooltip:{trigger:"axis"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:l.value.trend.map(e=>e.date),axisLabel:{formatter:e=>r(e,"MM-DD")}},yAxis:{type:"value"},series:[{name:"触发次数",type:"line",smooth:!0,data:l.value.trend.map(e=>e.count),areaStyle:{opacity:.1},lineStyle:{width:3},itemStyle:{color:"#1890ff"}}]};o.setOption(i)},M=()=>{h.push(`/track/edit/${l.value.id}`)},x=()=>{confirm("确定要删除这个事件吗？")&&h.push("/track/list")},w=i=>{const e=[],s=new Date;for(let u=i-1;u>=0;u--){const v=new Date(s);v.setDate(v.getDate()-u),e.push({date:r(v,"YYYY-MM-DD"),count:Math.floor(Math.random()*1e3+1e3)})}return e},E=i=>{f.value=i,l.value.trend=w(i),g()},b=()=>{o==null||o.resize()};return q(()=>{g(),window.addEventListener("resize",b)}),C(()=>{window.removeEventListener("resize",b),o==null||o.dispose()}),(i,e)=>(d(),a("div",P,[t("div",S,[t("div",A,[e[0]||(e[0]=t("h2",null,"事件详情",-1)),t("span",B,n(l.value.name),1)]),t("div",{class:"header-actions"},[t("button",{class:"action-btn edit-btn",onClick:M},"编辑事件"),t("button",{class:"action-btn delete-btn",onClick:x},"删除事件")])]),t("div",N,[e[5]||(e[5]=t("h3",null,"基本信息",-1)),t("div",j,[t("div",F,[e[1]||(e[1]=t("label",null,"事件描述",-1)),t("div",null,n(l.value.description),1)]),t("div",H,[e[2]||(e[2]=t("label",null,"事件类型",-1)),t("div",null,n(T(l.value.type)),1)]),t("div",O,[e[3]||(e[3]=t("label",null,"创建时间",-1)),t("div",null,n(y(r)(l.value.createdAt)),1)]),t("div",$,[e[4]||(e[4]=t("label",null,"最近触发",-1)),t("div",null,n(y(r)(l.value.lastTriggered)),1)])])]),t("div",J,[e[7]||(e[7]=t("h3",null,"事件属性",-1)),t("table",U,[e[6]||(e[6]=t("thead",null,[t("tr",null,[t("th",null,"属性名"),t("th",null,"数据类型"),t("th",null,"属性描述"),t("th",null,"是否必填")])],-1)),t("tbody",null,[(d(!0),a(m,null,_(l.value.properties,s=>(d(),a("tr",{key:s.key},[t("td",null,n(s.key),1),t("td",null,n(s.type),1),t("td",null,n(s.description),1),t("td",null,n(s.required?"是":"否"),1)]))),128))])])]),t("div",V,[t("div",G,[e[8]||(e[8]=t("h3",null,"触发趋势",-1)),t("div",K,[(d(),a(m,null,_(k,s=>t("button",{key:s.days,class:R(["period-btn",{active:f.value===s.days}]),onClick:u=>E(s.days)},n(s.label),11,Q)),64))])]),t("div",{ref_key:"trendChartRef",ref:p,class:"trend-chart"},null,512)]),t("div",W,[e[10]||(e[10]=t("h3",null,"最近触发记录",-1)),t("table",X,[e[9]||(e[9]=t("thead",null,[t("tr",null,[t("th",null,"触发时间"),t("th",null,"用户ID"),t("th",null,"设备类型"),t("th",null,"属性值")])],-1)),t("tbody",null,[(d(!0),a(m,null,_(D.value,s=>(d(),a("tr",{key:s.id},[t("td",null,n(y(r)(s.timestamp,"YYYY-MM-DD HH:mm:ss")),1),t("td",null,n(s.userId),1),t("td",null,n(s.deviceType),1),t("td",null,[t("pre",Z,n(JSON.stringify(s.properties,null,2)),1)])]))),128))])])])]))}},nt=Y(tt,[["__scopeId","data-v-8bec81e6"]]);export{nt as default};
