import{_ as H,r as u,p as I,q as F,s as X,c,a as e,F as _,d as g,l as q,m as G,x as V,y as P,h as d,o as v,n as j,t as o,g as J,u as m,b as k,T as U,z as K}from"./index-Lnb-9Fda.js";const Q={class:"event-analysis"},W={class:"page-header"},Y={class:"date-range"},Z=["onClick"],ee={class:"stat-cards"},te={class:"stat-header"},ae={class:"stat-title"},se={class:"stat-value"},le={class:"stat-trend"},oe={class:"chart-section"},ne={class:"chart-card"},ie={class:"chart-header"},re={class:"chart-actions"},ue={class:"analysis-section"},ce={class:"analysis-card"},de={class:"distribution-section"},ve={class:"distribution-cards"},pe={class:"distribution-card"},fe={class:"distribution-card"},me={__name:"EventAnalysis",setup(he){const z=[{days:0,label:"今天"},{days:7,label:"近7天"},{days:14,label:"近14天"},{days:30,label:"近30天"}],p=u(0),A=u([{title:"总浏览量(PV)",value:23456,current:.15,previous:.12,color:"#1890ff",icon:"👁️"},{title:"访客数(UV)",value:4567,current:.08,previous:.07,color:"#52c41a",icon:"👥"},{title:"平均停留时长",value:325,current:.12,previous:.1,color:"#722ed1",icon:"⏱️"},{title:"跳出率",value:.35,current:-.05,previous:.4,color:"#faad14",icon:"↩️"}]),C=u([{path:"/home",pv:4567,uv:1234,avgDuration:245,bounceRate:.25,conversionRate:.45,previousRate:.42},{path:"/products",pv:3456,uv:987,avgDuration:180,bounceRate:.3,conversionRate:.38,previousRate:.35},{path:"/cart",pv:2345,uv:765,avgDuration:120,bounceRate:.15,conversionRate:.65,previousRate:.62}]),f=u("both"),h=u(null),y=u(null),b=u(null);let l=null,n=null,i=null;const L=s=>{const a=Math.floor(s/60),t=s%60;return`${a}分${t}秒`},E=()=>{h.value&&(l=V(h.value),R())},R=()=>{if(!l)return;const s=$(),t=p.value===0?"HH:00":"MM-DD",S={tooltip:{trigger:"axis",formatter:function(r){let w=`${P(r[0].axisValue,t)}<br/>`;return r.forEach(x=>{const N=d(x.value);w+=`${x.seriesName}: ${N}<br/>`}),w}},legend:{data:["浏览量(PV)","访客数(UV)"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:s,axisLabel:{formatter:r=>P(r,t)}},yAxis:[{type:"value",name:"PV",position:"left",axisLabel:{formatter:r=>d(r)}},{type:"value",name:"UV",position:"right",axisLabel:{formatter:r=>d(r)}}],series:M()};l.setOption(S)},M=()=>{const s=[23456,25678,24567,26789,28901,27654,29876],a=[12345,13456,12789,14567,15678,14789,16543];return f.value==="pv"?[{name:"浏览量(PV)",type:"line",smooth:!0,data:s,areaStyle:{opacity:.1},itemStyle:{color:"#1890ff"}}]:f.value==="uv"?[{name:"访客数(UV)",type:"line",smooth:!0,data:a,areaStyle:{opacity:.1},itemStyle:{color:"#52c41a"}}]:[{name:"浏览量(PV)",type:"line",smooth:!0,data:s,areaStyle:{opacity:.1},itemStyle:{color:"#1890ff"}},{name:"访客数(UV)",type:"line",smooth:!0,data:a,areaStyle:{opacity:.1},itemStyle:{color:"#52c41a"},yAxisIndex:1}]},O=()=>{y.value&&(n=V(y.value),n.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"70%",data:[{value:45678,name:"PC端"},{value:34567,name:"iOS"},{value:23456,name:"Android"},{value:12345,name:"其他"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}))},T=()=>{b.value&&(i=V(b.value),i.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"70%",data:[{value:23456,name:"广东"},{value:19876,name:"北京"},{value:18765,name:"上海"},{value:15678,name:"浙江"},{value:12345,name:"其他"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}))},$=()=>{const s=[];if(p.value===0)for(let a=0;a<24;a++){const t=new Date;t.setHours(a,0,0,0),s.push(t)}else for(let a=p.value-1;a>=0;a--){const t=new Date;t.setDate(t.getDate()-a),s.push(t)}return s},B=s=>{p.value=s},D=()=>{l==null||l.resize(),n==null||n.resize(),i==null||i.resize()};return I(f,()=>{R()}),F(()=>{E(),O(),T(),window.addEventListener("resize",D)}),X(()=>{window.removeEventListener("resize",D),l==null||l.dispose(),n==null||n.dispose(),i==null||i.dispose()}),(s,a)=>(v(),c("div",Q,[e("div",W,[a[1]||(a[1]=e("h2",null,"数据分析",-1)),e("div",Y,[(v(),c(_,null,g(z,t=>e("button",{key:t.days,class:j(["date-btn",{active:p.value===t.days}]),onClick:S=>B(t.days)},o(t.label),11,Z)),64))])]),e("div",ee,[(v(!0),c(_,null,g(A.value,t=>(v(),c("div",{class:"stat-card",key:t.title},[e("div",te,[e("span",ae,o(t.title),1),e("span",{class:"stat-icon",style:J({background:t.color})},o(t.icon),5)]),e("div",se,o(m(d)(t.value)),1),e("div",le,[k(U,{value:t.current,"previous-value":t.previous,"with-sign":!0,format:"percentage"},null,8,["value","previous-value"]),a[2]||(a[2]=e("span",{class:"trend-label"},"较上期",-1))])]))),128))]),e("div",oe,[e("div",ne,[e("div",ie,[a[4]||(a[4]=e("h3",null,"PV/UV 趋势",-1)),e("div",re,[q(e("select",{"onUpdate:modelValue":a[0]||(a[0]=t=>f.value=t),class:"metric-select"},a[3]||(a[3]=[e("option",{value:"pv"},"浏览量(PV)",-1),e("option",{value:"uv"},"访客数(UV)",-1),e("option",{value:"both"},"PV/UV对比",-1)]),512),[[G,f.value]])])]),e("div",{ref_key:"trendChartRef",ref:h,class:"chart-container"},null,512)])]),e("div",ue,[e("div",ce,[a[6]||(a[6]=e("h3",null,"页面分析",-1)),e("table",null,[a[5]||(a[5]=e("thead",null,[e("tr",null,[e("th",null,"页面路径"),e("th",null,"浏览量(PV)"),e("th",null,"访客数(UV)"),e("th",null,"平均停留时长"),e("th",null,"跳出率"),e("th",null,"转化率")])],-1)),e("tbody",null,[(v(!0),c(_,null,g(C.value,t=>(v(),c("tr",{key:t.path},[e("td",null,o(t.path),1),e("td",null,o(m(d)(t.pv)),1),e("td",null,o(m(d)(t.uv)),1),e("td",null,o(L(t.avgDuration)),1),e("td",null,o(m(K)(t.bounceRate)),1),e("td",null,[k(U,{value:t.conversionRate,"previous-value":t.previousRate,format:"percentage"},null,8,["value","previous-value"])])]))),128))])])])]),e("div",de,[e("div",ve,[e("div",pe,[a[7]||(a[7]=e("h3",null,"设备分布",-1)),e("div",{ref_key:"deviceChartRef",ref:y,class:"pie-chart"},null,512)]),e("div",fe,[a[8]||(a[8]=e("h3",null,"地域分布",-1)),e("div",{ref_key:"regionChartRef",ref:b,class:"pie-chart"},null,512)])])])]))}},_e=H(me,[["__scopeId","data-v-1b3a738a"]]);export{_e as default};
